<section class="xp-section" id="experience" aria-labelledby="xp-title">
    <h2 class="xp-title" id="xp-title">Experiencia Laboral</h2>
    <div class="xp-actions">
        <!-- Descargar CV -->
        <a class="btn-cv" href="/assets/cv/sergio-marchado-cv.pdf" download="Sergio_Marchado_CV.pdf" target="_blank"
            rel="noopener" aria-label="Descargar CV en PDF">
            <span class="btn-cv__icon">
                <!-- Icono de descarga -->
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 16l4-5h-3V4h-2v7H8l4 5zm8-1v5H4v-5H2v7h20v-7h-2z" />
                </svg>
            </span>
            <span>Descargar CV</span>
        </a>

        <!-- Contáctame (abre mail app o muestra opciones web) -->
        <button class="btn-cv" type="button" (click)="contactMe()">
            <span class="btn-cv__icon">
                <!-- svg sobre -->
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                        d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z" />
                </svg>
            </span>
            <span>Contáctame</span>
        </button>

        <!-- Copiar Email -->
        <button class="btn-cv" type="button" (click)="copyEmail(email)">
            <span class="btn-cv__icon">
                <!-- svg portapapeles -->
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                        d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z" />
                </svg>
            </span>
            <span>Copiar email</span>
        </button>
    </div>

    <!-- Opciones web (solo si falla el mailto o por preferencia) -->
    <div class="xp-contact-web">
        <a class="btn-ghost" [href]="gmailHref" target="_blank" rel="noopener">Abrir en Gmail</a>
        <a class="btn-ghost" [href]="outlookHref" target="_blank" rel="noopener">Abrir en Outlook Web</a>
    </div>



    <ol class="xp-timeline">
        <li class="xp-card" *ngFor="let exp of items(); trackBy: trackById">
            <!-- Línea/marker timeline -->
            <span class="xp-line" aria-hidden="true"></span>
            <span class="xp-dot" aria-hidden="true"></span>

            <!-- Logo -->
            <div class="xp-logo">
                <img *ngIf="exp.logoUrl" [src]="exp.logoUrl" [alt]="exp.company" />
                <div *ngIf="!exp.logoUrl" class="xp-logo-fallback">{{ exp.company[0] || '?' }}</div>
            </div>

            <!-- Contenido -->
            <div class="xp-content">
                <header class="xp-header">
                    <h3 class="xp-role">{{ exp.role }}</h3>
                    <div class="xp-meta">
                        <span class="xp-company">
                            <a *ngIf="exp.url; else plain" [href]="exp.url" target="_blank" rel="noopener noreferrer">
                                {{ exp.company }}
                            </a>
                            <ng-template #plain>{{ exp.company }}</ng-template>
                        </span>
                        <span class="xp-dot-sep">•</span>
                        <span class="xp-dates">{{ exp.start }} - {{ exp.end || 'Actualidad' }}</span>

                        <!-- Duración opcional -->
                        <span *ngIf="exp.duration" class="xp-duration" title="Duración">{{ exp.duration }}</span>

                        <span *ngIf="exp.location" class="xp-dot-sep">•</span>
                        <span *ngIf="exp.location" class="xp-location">{{ exp.location }}</span>
                    </div>
                </header>

                <!-- Renderiza HTML en summary -->
                <p *ngIf="exp.summary" class="xp-summary" [innerHTML]="exp.summary"></p>

                <!-- Renderiza HTML en cada task -->
                <ul *ngIf="exp.tasks?.length" class="xp-tasks">
                    <li *ngFor="let t of exp.tasks" [innerHTML]="t"></li>
                </ul>

                <div *ngIf="exp.tech?.length" class="xp-tags">
                    <span class="xp-tag" *ngFor="let t of exp.tech">{{ t }}</span>
                </div>

                <!-- Referencias opcionales -->
                <div *ngIf="exp.references?.length" class="xp-references">
                    <h4>Referencias profesionales</h4>
                    <ul>
                        <li *ngFor="let ref of exp.references">
                            <strong>{{ ref.name }}</strong>
                            <span class="xp-ref-pos"> - {{ ref.position }}</span>
                            <a *ngIf="ref.phone" class="xp-ref-phone" [href]="'tel:' + ref.phone">{{ ref.phone }}</a>
                        </li>
                    </ul>
                </div>
            </div>
        </li>
    </ol>
</section>